<!-- this file was generated automatically by noweave; better not edit it-->
<html><head><title>rtest_init.nw</title></head><body><!--*   ****************************************************************-->
<!--*   * (c) Copyright 1997, 1998, 1999, 1900 The Regents of the      *-->
<!--*   *     University  of California.  All Rights Reserved.         *-->
<!--*   *                                                              *-->
<!--*   *     This work was produced under the sponsorship of the      *-->
<!--*   *     United States Department of Energy.  The Government      *-->
<!--*   *     retains certain rights therein.                          *-->
<!--*   ****************************************************************-->
<!--*   -->
<!--*   ****************************************************************-->
<!--*   This file uses the noweb utilities to generate the source code-->
<!--*   and documentation.-->
<!--*   To generate the LaTex file use:-->
<!--*   noweave -index rtest_init.nw rtest_support.nw > rtest_init.tex-->
<!--*   latex rtest_init.tex; latex rtest_init.tex-->
<!--*   To generate the PDF version use:-->
<!--*   dvipdfm rtest_init.dvi-->
<!--*   To generate the HTML file use:-->
<!--*   noweave -filter l2h -index -autodefs c -html -->
<!--*           rtest_init.nw > rtest_init.html-->
<!--*   to produce source code:-->
<!--*   notangle -L'%N' rtest_init.nw > <a name="NWD1">rtest_init.py--></a>
<!--*      note: the first empty line must be removed.-->
<!--*   ****************************************************************-->


<h1>Regression Initiation: <code>rtest_init</code></h1>
<address>Victor M. Castillo<br>Methods Development Group</address>
<!--title goes here--><p>

<h2><a name="NWD2">Scope</a></h2>
This <code>Python</code> script generates the <code>.info</code> file used by 
<code>rtest</code> to determine what element types are available within
each sample case. A <code>grizinit</code> file is created that instructs GRIZ
to dump the results of the <code>info</code> command to a file named <code>.info</code>.
<p>
<pre><a name="NWrteD-*-1" href="#NWD2"><dfn>&lt;*&gt;=</dfn></a>
#!/usr/bin/env /grdev/regrtest/bin/python
<a name="NWrteD-*-1-u1" href="#NWrteD-ini4-1"><i>&lt;init&gt;</i></a>

</pre><pre><a name="NWrteD-ini4-1" href="#NWrteD-ini4-1"><dfn>&lt;init&gt;=</dfn></a> <b>(<a href="#NWD2">&lt;-U</a>)</b>
<a name="NWrteD-ini4-1-u1" href="#nw@notdef"><i>&lt;rtest support&gt;</i></a>
#import os,re,string
from rtest_support import *

&quot;&quot;&quot;This routine does some basic initialization for the
regression testing.

A <a href="#NWrteD-ini4-1">griz</a> binary is called to generate an ascii file with
*/.info* about the sample file. The file is then parsed
to determine the relevant elements.

***This only needs to be run once for each sample***
&quot;&quot;&quot;

generate=1

GRIZBIN=TEST['bin'][0]
DB='d3plot'
for sample in CASE['SAMP']+CASE['SND']:
   print(&quot;Analyzing data for &quot;+sample+&quot;...&quot;)
   os.chdir(RHOME+sample+&quot;/&quot;)
   if generate:
      g=open('grizinit','w+')    #create grizinit file 
      g.write(HEADER)
      g.write(&quot;savtxt .info\n&quot;)
      g.write(&quot;info\n&quot;)
      g.write(&quot;endtxt\n&quot;)
      g.write(&quot;savtxt done\n&quot;)
      g.write(&quot;endtxt\n&quot;)
      g.write(&quot;quit\n&quot;)
      g.close()
      err=os.system(GRIZBIN+&quot; -i &quot;+DB)   #run <a href="#NWrteD-ini4-1">griz</a> with new grizinit file
      if not os.path.exists('done'):
         print(&quot;waiting ...&quot;)
      while not os.path.exists('done'):
         pass
      os.remove('done')
      os.remove('grizinit')
   #Now parse .info file
   if not os.path.exists('.info'):
      print(&quot;ERROR: No info file found.&quot;)
   info=open('.info','r+')
   raw = info.read() 
   info.close()
   #
   for key in IS.keys():
      etest = re.compile(IS[key][0])
      if etest.search(raw):
         np=string.replace(IS[key][0],':','')
         print(&quot;&gt;&gt;&gt; &quot;+np+&quot; detected in &quot;+sample)
</pre><blockquote>Defines <a href="#NWI-griz"><code>griz</code></a> (links are to index).<p>
</blockquote>

<ul>
<li><a href="#NWD2"><i>&lt;*&gt;</i></a>: <a href="#NWD2">D1</a>
<li><a href="#NWrteD-ini4-1"><i>&lt;init&gt;</i></a>: <a href="#NWD2">U1</a>, <a href="#NWrteD-ini4-1">D2</a>
<li><a href="#nw@notdef"><i>&lt;rtest support&gt;</i></a>: <a href="#NWrteD-ini4-1">U1</a>
</ul>
<ul>
<li><a name="NWI-griz" href="#NWrteD-ini4-1">griz</a>: <a href="#NWrteD-ini4-1">D1</a>
</ul>
</body></html>

